Loaded model weights.
Running full evaluation on dataset...

--- Model Metrics ---
Atelectasis: AUC = 0.8422
Cardiomegaly: AUC = 0.9586
Effusion: AUC = 0.9207
Infiltration: AUC = 0.7630
Mass: AUC = 0.9030
Nodule: AUC = 0.7904
Pneumonia: AUC = 0.7838
Pneumothorax: AUC = 0.9424
Consolidation: AUC = 0.8620
Edema: AUC = 0.9486
Emphysema: AUC = 0.9396
Fibrosis: AUC = 0.8801
Pleural_Thickening: AUC = 0.8366
Hernia: AUC = 0.9945

Mean AUC: 0.8832

--- Classification Report (Threshold 0.5) ---
                    precision    recall  f1-score   support

       Atelectasis       0.55      0.20      0.29       570
      Cardiomegaly       0.65      0.41      0.50       252
          Effusion       0.76      0.36      0.49       642
      Infiltration       0.59      0.09      0.15      1026
              Mass       0.64      0.22      0.33       212
            Nodule       0.43      0.05      0.08       264
         Pneumonia       0.00      0.00      0.00        85
      Pneumothorax       0.80      0.37      0.50       265
     Consolidation       1.00      0.02      0.03       263
             Edema       1.00      0.01      0.02       112
         Emphysema       0.56      0.39      0.46       154
          Fibrosis       0.62      0.05      0.10       193
Pleural_Thickening       0.75      0.03      0.06       209
            Hernia       0.95      0.58      0.72        31

         micro avg       0.66      0.18      0.29      4278
         macro avg       0.66      0.20      0.27      4278
      weighted avg       0.65      0.18      0.26      4278
       samples avg       0.11      0.08      0.09      4278


Generating Grad-CAM visualizations...
Image 67070: Predicted Nodule (0.35)
Saved gradcam_result_67070.png
Image 63970: Predicted Mass (0.40)
Saved gradcam_result_63970.png
Image 55180: Predicted Mass (0.51)
Saved gradcam_result_55180.png
Image 103167: Predicted Infiltration (0.21)
Saved gradcam_result_103167.png
Image 80715: Predicted Infiltration (0.14)
Saved gradcam_result_80715.png
